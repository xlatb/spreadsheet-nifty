#!/usr/bin/perl -w
use warnings;
use strict;

package Spreadsheet::Nifty::XLS::RecordTypes;

# Worksheet stream record types
# https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-xls/43684742-8fcd-4fcd-92df-157d8d7241f9
# https://www.openoffice.org/sc/excelfileformat.pdf

use constant
{
  # Substream start/end
  BOF => 0x0809,
  EOF => 0x000A,

  # Workbook or worksheet header
  PASSWORD => 0x0013,

  # Workbook header
  FILE_PASS     => 0x002F,
  DATE_1904     => 0x0022,
  FONT          => 0x0031,
  FORMAT        => 0x041E,
  BOUND_SHEET_8 => 0x0085,  # Called 'SHEET' by OpenOffice, 'BoundSheet8' by MS
  LBL           => 0x0018,  # Called 'DEFINEDNAME' by OpenOffice, 'Lbl' by MS
  SST           => 0x00FC,
  PALETTE       => 0x0092,
  STYLE         => 0x0293,
  PROTECT       => 0x0012,
  RR_TAB_ID     => 0x013D,  # OpenOffice mentions 'TABID' record but doesn't define it
  INTERFACE_HDR => 0x00E1,
  INTERFACE_END => 0x00E2,
  XF            => 0x00E0,
  XF_CRC        => 0x087C,
  XF_EXT        => 0x087D,
  DXF           => 0x088D,

  # Worksheet header
  AUTO_FILTER        => 0x009E,
  AUTO_FILTER_12     => 0x087E,
  AUTO_FILTER_INFO   => 0x009D,
  INDEX              => 0x020B,
  DEFAULT_ROW_HEIGHT => 0x0225,
  WS_BOOL            => 0x0081,  # Called 'SHEETPR' by OpenOffice, 'WsBool' by MS
  DEF_COL_WIDTH      => 0x0055,
  COL_INFO           => 0x007D,
  DIMENSIONS         => 0x0200,

  # Worksheet body
  UNCALCED       => 0x005E,
  ROW            => 0x0208,
  BLANK          => 0x0201,
  NUMBER         => 0x0203,
  LABEL          => 0x0204,
  LABEL_SST      => 0x00FD,
  BOOL_ERR       => 0x0205,
  RSTRING        => 0x00D6,
  RK             => 0x027E,
  FORMULA        => 0x0006,
  STRING         => 0x0207,
  MUL_BLANK      => 0x00BE,
  MUL_RK         => 0x00BD,
  SHARED_FORMULA => 0x04BC,  # Called 'SHAREDFMLA' by OpenOffice, 'ShrFmla' by MS
  ARRAY          => 0x0221,
  TABLE          => 0x0236,  # Called 'DATATABLE' by OpenOffice, 'Table' by MS

  # General
  CONTINUE       => 0x003C,
};

# This list is intended to be comprehensive.
my $xlsRecordNames =
{
'0006' => 'Formula',
'000A' => 'EOF',
'000C' => 'CalcCount',
'000D' => 'CalcMode',
'000E' => 'CalcPrecision',
'000F' => 'CalcRefMode',
'0010' => 'CalcDelta',
'0011' => 'CalcIter',
'0012' => 'Protect',
'0013' => 'Password',
'0014' => 'Header',
'0015' => 'Footer',
'0016' => 'EXTERNCOUNT',  # BIFF5?
'0017' => 'ExternSheet',
'0018' => 'Lbl',
'0019' => 'WinProtect',
'001A' => 'VerticalPageBreaks',
'001B' => 'HorizontalPageBreaks',
'001C' => 'Note',
'001D' => 'Selection',
'0022' => 'Date1904',
'0023' => 'ExternName',
'0026' => 'LeftMargin',
'0027' => 'RightMargin',
'0028' => 'TopMargin',
'0029' => 'BottomMargin',
'002A' => 'PrintRowCol',
'002B' => 'PrintGrid',
'002F' => 'FilePass',
'0031' => 'Font',
'0033' => 'PrintSize',
'003C' => 'Continue',
'003D' => 'Window1',
'0040' => 'Backup',
'0041' => 'Pane',
'0042' => 'CodePage',
'004D' => 'Pls',
'0050' => 'DCon',
'0051' => 'DConRef',
'0052' => 'DConName',
'0055' => 'DefColWidth',
'0059' => 'XCT',
'005A' => 'CRN',
'005B' => 'FileSharing',
'005C' => 'WriteAccess',
'005D' => 'Obj',
'005E' => 'Uncalced',
'005F' => 'CalcSaveRecalc',
'0060' => 'Template',
'0061' => 'Intl',
'0063' => 'ObjProtect',
'007D' => 'ColInfo',
'0080' => 'Guts',
'0081' => 'WsBool',
'0082' => 'GridSet',
'0083' => 'HCenter',
'0084' => 'VCenter',
'0085' => 'BoundSheet8',
'0086' => 'WriteProtect',
'008C' => 'Country',
'008D' => 'HideObj',
'0090' => 'Sort',
'0092' => 'Palette',
'0097' => 'Sync',
'0098' => 'LPr',
'0099' => 'DxGCol',
'009A' => 'FnGroupName',
'009B' => 'FilterMode',
'009C' => 'BuiltInFnGroupCount',
'009D' => 'AutoFilterInfo',
'009E' => 'AutoFilter',
'00A0' => 'Scl',
'00A1' => 'Setup',
'00AB' => 'GCW',
'00AE' => 'ScenMan',
'00AF' => 'SCENARIO',
'00B0' => 'SxView',
'00B1' => 'Sxvd',
'00B2' => 'SXVI',
'00B4' => 'SxIvd',
'00B5' => 'SXLI',
'00B6' => 'SXPI',
'00B8' => 'DocRoute',
'00B9' => 'RecipName',
'00BD' => 'MulRk',
'00BE' => 'MulBlank',
'00BF' => 'TOOLBARHDR',  # BIFF5?
'00C0' => 'TOOLBAREND',  # BIFF5?
'00C1' => 'Mms',
'00C5' => 'SXDI',
'00C6' => 'SXDB',
'00C7' => 'SXFDB',
'00C8' => 'SXDBB',
'00C9' => 'SXNum',
'00CA' => 'SxBool',
'00CB' => 'SxErr',
'00CC' => 'SXInt',
'00CD' => 'SXString',
'00CE' => 'SXDtr',
'00CF' => 'SxNil',
'00D0' => 'SXTbl',
'00D1' => 'SXTBRGIITM',
'00D2' => 'SxTbpg',
'00D3' => 'ObProj',
'00D5' => 'SXStreamID',
'00D6' => 'RString',
'00D7' => 'DBCell',
'00D8' => 'SXRng',
'00D9' => 'SxIsxoper',
'00DA' => 'BookBool',
'00DC' => 'DbOrParamQry',
'00DD' => 'ScenarioProtect',
'00DE' => 'OleObjectSize',
'00E0' => 'XF',
'00E1' => 'InterfaceHdr',
'00E2' => 'InterfaceEnd',
'00E3' => 'SXVS',
'00E5' => 'MergeCells',
'00E9' => 'BkHim',
'00EB' => 'MsoDrawingGroup',
'00EC' => 'MsoDrawing',
'00ED' => 'MsoDrawingSelection',
'00EF' => 'PhoneticInfo',
'00F0' => 'SxRule',
'00F1' => 'SXEx',
'00F2' => 'SxFilt',
'00F4' => 'SxDXF',
'00F5' => 'SxItm',
'00F6' => 'SxName',
'00F7' => 'SxSelect',
'00F8' => 'SXPair',
'00F9' => 'SxFmla',
'00FB' => 'SxFormat',
'00FC' => 'SST',
'00FD' => 'LabelSst',
'00FF' => 'ExtSST',
'0100' => 'SXVDEx',
'0103' => 'SXFormula',
'0122' => 'SXDBEx',
'0137' => 'RRDInsDel',
'0138' => 'RRDHead',
'013B' => 'RRDChgCell',
'013D' => 'RRTabId',
'013E' => 'RRDRenSheet',
'013F' => 'RRSort',
'0140' => 'RRDMove',
'014A' => 'RRFormat',
'014B' => 'RRAutoFmt',
'014D' => 'RRInsertSh',
'014E' => 'RRDMoveBegin',
'014F' => 'RRDMoveEnd',
'0150' => 'RRDInsDelBegin',
'0151' => 'RRDInsDelEnd',
'0152' => 'RRDConflict',
'0153' => 'RRDDefName',
'0154' => 'RRDRstEtxp',
'015F' => 'LRng',
'0160' => 'UsesELFs',
'0161' => 'DSF',
'0191' => 'CUsr',
'0192' => 'CbUsr',
'0193' => 'UsrInfo',
'0194' => 'UsrExcl',
'0195' => 'FileLock',
'0196' => 'RRDInfo',
'0197' => 'BCUsrs',
'0198' => 'UsrChk',
'01A9' => 'UserBView',
'01AA' => 'UserSViewBegin_Chart',
'01AB' => 'UserSViewEnd',
'01AC' => 'RRDUserView',
'01AD' => 'Qsi',
'01AE' => 'SupBook',
'01AF' => 'Prot4Rev',
'01B0' => 'CondFmt',
'01B1' => 'CF',
'01B2' => 'DVal',
'01B5' => 'DconBin',
'01B6' => 'TxO',
'01B7' => 'RefreshAll',
'01B8' => 'HLink',
'01B9' => 'Lel',
'01BA' => 'CodeName',
'01BB' => 'SXFDBType',
'01BC' => 'Prot4RevPass',
'01BD' => 'ObNoMacros',
'01BE' => 'Dv',
'01C0' => 'Excel9File',
'01C1' => 'RecalcId',
'01C2' => 'EntExU2',
'0200' => 'Dimensions',
'0201' => 'Blank',
'0203' => 'Number',
'0204' => 'Label',
'0205' => 'BoolErr',
'0207' => 'String',
'0208' => 'Row',
'020B' => 'Index',
'0221' => 'Array',
'0225' => 'DefaultRowHeight',
'0236' => 'Table',
'023E' => 'Window2',
'027E' => 'RK',
'0293' => 'Style',
'0418' => 'BigName',
'041E' => 'Format',
'043C' => 'ContinueBigName',
'04BC' => 'ShrFmla',
'0800' => 'HLinkTooltip',
'0801' => 'WebPub',
'0802' => 'QsiSXTag',
'0803' => 'DBQueryExt',
'0804' => 'ExtString',
'0805' => 'TxtQry',
'0806' => 'Qsir',
'0807' => 'Qsif',
'0808' => 'RRDTQSIF',
'0809' => 'BOF',
'080A' => 'OleDbConn',
'080B' => 'WOpt',
'080C' => 'SXViewEx',
'080D' => 'SXTH',
'080E' => 'SXPIEx',
'080F' => 'SXVDTEx',
'0810' => 'SXViewEx9',
'0812' => 'ContinueFrt',
'0813' => 'RealTimeData',
'0850' => 'ChartFrtInfo',
'0851' => 'FrtWrapper',
'0852' => 'StartBlock',
'0853' => 'EndBlock',
'0854' => 'StartObject',
'0855' => 'EndObject',
'0856' => 'CatLab',
'0857' => 'YMult',
'0858' => 'SXViewLink',
'0859' => 'PivotChartBits',
'085A' => 'FrtFontList',
'0862' => 'SheetExt',
'0863' => 'BookExt',
'0864' => 'SXAddl',
'0865' => 'CrErr',
'0866' => 'HFPicture',
'0867' => 'FeatHdr',
'0868' => 'Feat',
'086A' => 'DataLabExt',
'086B' => 'DataLabExtContents',
'086C' => 'CellWatch',
'0871' => 'FeatHdr11',
'0872' => 'Feature11',
'0874' => 'DropDownObjIds',
'0875' => 'ContinueFrt11',
'0876' => 'DConn',
'0877' => 'List12',
'0878' => 'Feature12',
'0879' => 'CondFmt12',
'087A' => 'CF12',
'087B' => 'CFEx',
'087C' => 'XFCRC',
'087D' => 'XFExt',
'087E' => 'AutoFilter12',
'087F' => 'ContinueFrt12',
'0884' => 'MDTInfo',
'0885' => 'MDXStr',
'0886' => 'MDXTuple',
'0887' => 'MDXSet',
'0888' => 'MDXProp',
'0889' => 'MDXKPI',
'088A' => 'MDB',
'088B' => 'PLV',
'088C' => 'Compat12',
'088D' => 'DXF',
'088E' => 'TableStyles',
'088F' => 'TableStyle',
'0890' => 'TableStyleElement',
'0892' => 'StyleExt',
'0893' => 'NamePublish',
'0894' => 'NameCmt',
'0895' => 'SortData',
'0896' => 'Theme',
'0897' => 'GUIDTypeLib',
'0898' => 'FnGrp12',
'0899' => 'NameFnGrp12',
'089A' => 'MTRSettings',
'089B' => 'CompressPictures',
'089C' => 'HeaderFooter',
'089D' => 'CrtLayout12',
'089E' => 'CrtMlFrt',
'089F' => 'CrtMlFrtContinue',
'08A3' => 'ForceFullCalculation',
'08A4' => 'ShapePropsStream',
'08A5' => 'TextPropsStream',
'08A6' => 'RichTextStream',
'08A7' => 'CrtLayout12A',
'1001' => 'Units',
'1002' => 'Chart',
'1003' => 'Series',
'1006' => 'DataFormat',
'1007' => 'LineFormat',
'1009' => 'MarkerFormat',
'100A' => 'AreaFormat',
'100B' => 'PieFormat',
'100C' => 'AttachedLabel',
'100D' => 'SeriesText',
'1014' => 'ChartFormat',
'1015' => 'Legend',
'1016' => 'SeriesList',
'1017' => 'Bar',
'1018' => 'Line',
'1019' => 'Pie',
'101A' => 'Area',
'101B' => 'Scatter',
'101C' => 'CrtLine',
'101D' => 'Axis',
'101E' => 'Tick',
'101F' => 'ValueRange',
'1020' => 'CatSerRange',
'1021' => 'AxisLine',
'1022' => 'CrtLink',
'1024' => 'DefaultText',
'1025' => 'Text',
'1026' => 'FontX',
'1027' => 'ObjectLink',
'1032' => 'Frame',
'1033' => 'Begin',
'1034' => 'End',
'1035' => 'PlotArea',
'103A' => 'Chart3d',
'103C' => 'PicF',
'103D' => 'DropBar',
'103E' => 'Radar',
'103F' => 'Surf',
'1040' => 'RadarArea',
'1041' => 'AxisParent',
'1043' => 'LegendException',
'1044' => 'ShtProps',
'1045' => 'SerToCrt',
'1046' => 'AxesUsed',
'1048' => 'SBaseRef',
'104A' => 'SerParent',
'104B' => 'SerAuxTrend',
'104E' => 'IFmtRecord',
'104F' => 'Pos',
'1050' => 'AlRuns',
'1051' => 'BRAI',
'105B' => 'SerAuxErrBar',
'105C' => 'ClrtClient',
'105D' => 'SerFmt',
'105F' => 'Chart3DBarShape',
'1060' => 'Fbi',
'1061' => 'BopPop',
'1062' => 'AxcExt',
'1063' => 'Dat',
'1064' => 'PlotGrowth',
'1065' => 'SIIndex',
'1066' => 'GelFrame',
'1067' => 'BopPopCustom',
'1068' => 'Fbi2',
};

sub name($)
{
  my $class = shift();
  my ($num) = @_;

  return $xlsRecordNames->{sprintf("%04X", $num)};
}

1;
